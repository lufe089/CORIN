{"version":3,"sources":["webpack:///src/components/BusinessLogic/TheMainInstrumentTablesItems.vue","webpack:///./src/components/BusinessLogic/TheMainInstrumentTablesItems.vue","webpack:///./src/components/BusinessLogic/TheMainInstrumentTablesItems.vue?0c5e"],"names":["TheMainInstrumentTablesItems","name","props","caption","type","String","default","hover","Boolean","striped","bordered","small","fixed","improvementOptions","Array","_BDData","appliesLikertOptions","data","responsesList","fields","key","sortable","label","class","currentPage","subItems","perPage","totalRows","totalItems","dataLevelTwo","responsesByCategoriesList","company","company_contact_name","company_email","mounted","this","$store","commit","mutations_type","loadEmptySurvey","methods","getRowCount","items","length","toggleReview","row","needReview","addProgress","response","isFilled","state","calculateProgressByCategories","clearLikertScale","N_A","numericAnswer","_this","asyncToGenerator_default","regenerator_default","a","mark","_callee","wrap","_context","prev","next","dispatch","actions_type","api","getAll","endPoints","itemsSpanish","then","status","console","log","prepareData","categories","prepareItemResponses","info","catch","exception","message","finally","stop","i","level2","category","filter","result","item","id","push","createFakeResponses","itemResponse","answer_numeric","Math","round","random","t","itemsByCategory","itemLevel2","responsesSubItemsByCategory","itemId","item_id","is_complete","responsesByCategory","progressReponses","responsesCount","allFilled","responses","totalPotentialResponses","progressByCategory","saveItem2Responses","$emit","onSubmit","evt","preventDefault","getState","components","computed","extends_default","completed","progress","number","toFixed","progressBar","Number","Object","vuex_esm","__vue_styles__","context","__webpack_require__","Component","component_normalizer","_vm","_h","$createElement","_c","_self","staticClass","on","submit","_l","categoryAndItems","attrs","responsive","stacked","current-page","per-page","caption-top","scopedSlots","_u","fn","_v","_s","item_order","component","_e","dimension","fluid","required","toString","change","$event","model","value","callback","$$v","$set","expression","text","slot","$t","variant","pill","md","size","__webpack_exports__"],"mappings":"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","file":"static/js/3.04b7008cb7602153bcc4.js","sourcesContent":["<template>\r\n<div class=\"animated fadeIn\">\r\n  <b-card class=\"card-body\">\r\n    <!--Iterate over the different categories -->\r\n    <!--<div class=\"loading\">Loading&#8230;</div>-->\r\n    <b-form @submit=\"onSubmit\">\r\n      <div v-for=\"categoryAndItems in responsesByCategoriesList\" :key=\"categoryAndItems.id\">\r\n       <!-- Tabla -->\r\n        <b-table :hover='hover' :bordered='bordered' :small='small'  responsive stacked='sm' :items='categoryAndItems.responsesByCategory' :fields='fields' :current-page='currentPage' :per-page='perPage' caption-top>\r\n        <template slot=\"table-caption\">\r\n        <!-- Progress section -->\r\n        <div class='float-right'>\r\n          <small>{{$t('message.general_progress')}}</small>\r\n          <i class=\"fa fa-battery-2\"></i>\r\n          <!-- <span class=\"title\">{{$t('message.progress')}}</span> -->\r\n          <span class=\"value\">{{completed}}/ {{totalItems}} <span class=\"text-muted small\">{{progress}}%</span></span>\r\n          <div class=\"bars\">\r\n            <b-progress class=\"progress-xs\" :value=\"progressBar\" variant=\"info\" ></b-progress>\r\n          </div>\r\n        </div>\r\n        <!-- Group level name -->\r\n        <div class=\"h5 text-primary mb-0 mt-2 text-uppercase\">{{categoryAndItems.category.name}}  <small> {{categoryAndItems.responsesCount}}/{{categoryAndItems.responsesByCategory.length}} </small> </div>\r\n        <div class=\"float\"><b-badge variant=\"dark\" v-if=\"categoryAndItems.allFilled\" pill>{{$t('message.all_fill')}}</b-badge></div>\r\n        <div class=\"float\"><b-progress :value=\"categoryAndItems.progressReponses\" variant=\"info\" striped class=\"mb-2\"></b-progress></div>\r\n        </template>\r\n        <template slot='item_order' slot-scope='data'>\r\n          <!--Esta es la ruta para llegar data.item es un arreglo, item es el primer elemento item luego es un campo dentro del elemento-->\r\n          <small>{{data.item.item.item.item_order}}</small>\r\n        </template>\r\n        <template slot='component' slot-scope='data'>\r\n          <span v-if='data.item.item.item.component != null'>{{data.item.item.item.component.name}} </span>\r\n          <span v-if='data.item.item.item.component == null'> -- </span>\r\n        </template>\r\n        <template slot='dimension' slot-scope='data'>\r\n          {{data.item.item.item.dimension.name}}\r\n        </template>\r\n        <template slot='name' slot-scope='data'>\r\n          <div fluid class=\"mx-auto\">\r\n            {{data.item.item.name}}\r\n          </div>\r\n        </template>\r\n        <!-- Likert scale -->\r\n        <template slot='responseFormat' slot-scope='data'>\r\n        <div>\r\n          <b-form-radio-group required :name=\"'likertScale'+data.item.item_id.toString()\" :id=\"'likertScale'+data.item.item_id.toString()\" v-model=\"data.item.answer_numeric\"  v-on:change=\"addProgress(data.item)\" :state=\"getState(data.item)\">\r\n            <!-- For debugging purposes\r\n            <small>name likertScale {{data.item.itemId.toString()}}</small>\r\n            <small>save in {{data.item.itemId +' answer: ' +data.item.numericAnswer }}{{data.item}}</small>-->\r\n            <div v-for='(value, key) in appliesLikertOptions' :key='key' class='custom-control-inline py-0'>\r\n              <b-form-radio :value='value.value'>\r\n                <small>{{value.text}}</small>\r\n              </b-form-radio>\r\n            </div>\r\n          </b-form-radio-group>\r\n        </div>\r\n        </template>\r\n      </b-table>\r\n      <nav>\r\n      <!--<b-pagination :total-rows='getRowCount(responsesList)' :per-page='perPage' v-model='currentPage' prev-text='Prev' next-text='Next' hide-goto-end-buttons/>-->\r\n      </nav>\r\n     </div>\r\n    <b-row>\r\n      <b-col md=\"12\">\r\n      <div slot=\"footer\" class=\"float-right\">\r\n        <b-button type=\"submit\" size=\"m\" variant=\"primary\" >\r\n          <i class=\"fa fa-dot-circle-o\"></i> {{ $t(\"message.save\") }}\r\n        </b-button>\r\n      </div>\r\n      </b-col>\r\n    </b-row>\r\n    </b-form>\r\n  </b-card>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport BDData from '@/common/_BDData.js'\r\nimport api from '@/services/api'\r\nimport { mapGetters } from 'vuex'\r\nimport { FETCH_CATEGORIES } from '@/store/actions.type'\r\nimport { SET_LOADING, SET_ERROR, CLEAR_ERRORS } from '@/store/mutations.type'\r\nexport default {\r\n  name: 'the-main-instrument-tables-items',\r\n  props: {\r\n    caption: {\r\n      type: String,\r\n      default: 'Table'\r\n    },\r\n    hover: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    striped: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    bordered: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    small: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    fixed: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    improvementOptions: {\r\n      type: Array,\r\n      default: function () { return BDData.improvementOptions }\r\n    },\r\n    appliesLikertOptions: {\r\n      type: Array,\r\n      default: function () { return BDData.appliesLikertOptions }\r\n    }\r\n  },\r\n  data: () => {\r\n    return {\r\n      responsesList: [],\r\n      // items: BDData.customizedInstrument.itemsHierarchy.motivationHierarchy.hierarchicalItem.subHierarchicalItems.subItems\r\n      fields: [\r\n        // {key: 'item_order', sortable: true, label: '#'},\r\n        // {key: 'dimension', sortable: true, label: 'Dimensión'}, // No se deben mostrar\r\n        // {key: 'component', sortable: true, label: 'Componente'},// No se deben mostrar\r\n        {key: 'name', sortable: true, label: 'Item'},\r\n        {key: 'responseFormat', label: 'Total desacuerdo (1) -- Total acuerdo (9)', class: 'scaleWidthResults'}\r\n        // {key: 'upperAnchor', label: ''}\r\n      ],\r\n      currentPage: 1,\r\n      subItems: [],\r\n      perPage: 17,\r\n      totalRows: 0,\r\n      totalItems: 0,\r\n      dataLevelTwo: [],\r\n      responsesByCategoriesList: [],\r\n      company: {company_contact_name: 'Prueba', company_email: 'luisaEmailTest'}\r\n    }\r\n  },\r\n  mounted: function () {\r\n    this.$store.commit(CLEAR_ERRORS)\r\n    this.loadEmptySurvey()\r\n  },\r\n  methods: {\r\n    getRowCount (items) {\r\n      return items.length\r\n    },\r\n    toggleReview (row) {\r\n      /* Chages the justification of an item from visible to visible and vice-versa */\r\n      row.needReview = !row.needReview\r\n    },\r\n    addProgress (response) {\r\n      /* Event called when a likert option is selected */\r\n      response.isFilled = true\r\n      response.state = true\r\n      this.calculateProgressByCategories()\r\n    },\r\n    clearLikertScale (response) {\r\n      /*\r\n      This condition is hired with false because the onchage event is render before the actual value of the control is changed\r\n      then the event is hired before the checkbox has the true value that means the N_A field was selected  */\r\n      if (response.N_A === false) {\r\n        // We disable the items selected in case the N/A option was selected\r\n        response.numericAnswer = null\r\n        response.isFilled = true\r\n      } else {\r\n        // Si ya se deselecciona la escala de likert entonces se asume que el campo no ha sido lleno\r\n        response.isFilled = false\r\n      }\r\n    },\r\n    async loadEmptySurvey () {\r\n      /* Consume los servicios que se exponen en el servidor de django  usado el store \"survey\" de vuex */\r\n      this.$store.dispatch(FETCH_CATEGORIES)\r\n      this.$store.commit(SET_LOADING, true)\r\n      // Le pongo el await para que espere que las categorias se hubieran cargado antes de seguir\r\n      await api.getAll(BDData.endPoints.itemsSpanish)\r\n        .then(response => {\r\n          if (response.status === 200) {\r\n            console.log(response.data)\r\n            this.subItems = response.data\r\n            this.totalItems = this.subItems.length\r\n            // Categories y subItems vienen de getters del local storage\r\n            this.prepareData(this.categories, this.subItems)\r\n            // TODO hace aqui un arreglo pq si ya existe solo hay que cargar los datos\r\n            this.prepareItemResponses()\r\n            console.info('Consultados datos de los items')\r\n            this.$store.commit(SET_LOADING, false)\r\n          }\r\n        }).catch(exception => {\r\n          this.$store.commit(SET_ERROR, exception.message)\r\n        }).finally(\r\n          this.$store.commit(SET_LOADING, false)\r\n        )\r\n    },\r\n    prepareData: function (categories, items) {\r\n      // Organiza los items agrupandolos por categoria\r\n      this.$store.commit(SET_LOADING, true)\r\n      for (var i = 0; i < categories.length; i++) {\r\n        var level2 = {}\r\n        level2.category = categories[i]\r\n        level2.responsesList = items.filter(result => result.item.category.id === categories[i].id)\r\n        this.dataLevelTwo.push(level2)\r\n      }\r\n      this.$store.commit(SET_LOADING, false)\r\n    },\r\n    createFakeResponses (itemResponse) {\r\n      itemResponse.answer_numeric = Math.round((Math.random() * 10))\r\n      if (itemResponse.answer_numeric < 1 || itemResponse.answer_numeric > 9) {\r\n        // Si queda mal generado el numero aleatorio lo ajusto\r\n        itemResponse.answer_numeric = 9\r\n      }\r\n      itemResponse.isFilled = true\r\n    },\r\n    prepareItemResponses () { // Crea los objetos de tipo respuesta que son los que se almacena luego en la bd\r\n      /* Creates a list of objects that will save user answers */\r\n      for (var t = 0; t < this.dataLevelTwo.length; t++) {\r\n        var itemLevel2 = this.dataLevelTwo[t]\r\n        // Por cada elemento de nivel 2 se recorren su subitems\r\n        var responsesSubItemsByCategory = []\r\n        var itemsByCategory = 0\r\n        var progress = 0.0\r\n        for (var i = 0; i < itemLevel2.responsesList.length; i++) {\r\n          var itemResponse = {}\r\n          var itemId = itemLevel2.responsesList[i].id\r\n          itemResponse.name = itemLevel2.responsesList[i].name\r\n          itemResponse.item_id = itemId\r\n          itemResponse.item = itemLevel2.responsesList[i]\r\n          itemResponse.answer_numeric = null\r\n          itemResponse.isFilled = false\r\n          itemResponse.is_complete = true\r\n          this.createFakeResponses(itemResponse)\r\n          responsesSubItemsByCategory.push(itemResponse)\r\n          this.responsesList.push(itemResponse)\r\n        }\r\n        itemsByCategory = responsesSubItemsByCategory.length\r\n        //  We iterate this list in template to present the data of each category\r\n        this.responsesByCategoriesList.push({'category': itemLevel2.category, 'responsesByCategory': responsesSubItemsByCategory, 'itemsByCategory': itemsByCategory, 'progressReponses': progress, 'responsesCount': 0, 'allFilled': false})\r\n      }\r\n    },\r\n    calculateProgressByCategories () {\r\n      for (var i = 0; i < this.responsesByCategoriesList.length; i++) {\r\n        var responses = this.responsesByCategoriesList[i].responsesByCategory\r\n        var totalPotentialResponses = responses.length\r\n        this.responsesByCategoriesList[i].responsesCount = responses.filter(response => response.isFilled).length\r\n        var progressByCategory = this.responsesByCategoriesList[i].responsesCount / totalPotentialResponses\r\n        progressByCategory = progressByCategory * 100\r\n        this.responsesByCategoriesList[i].progressReponses = progressByCategory\r\n        if (this.responsesByCategoriesList[i].responsesCount === totalPotentialResponses) {\r\n          this.responsesByCategoriesList[i].allFilled = true\r\n        }\r\n      }\r\n    },\r\n    saveItem2Responses () {\r\n      console.log('Guardando ...')\r\n      // Se emite el mensaje para que el padre se encargue de guardar en la base de datos\r\n      this.$emit('item-level2-table:change', this.responsesList)\r\n    },\r\n    onSubmit (evt) {\r\n      // the page doesn’t reload when the form is submitted,\r\n      evt.preventDefault()\r\n      // this.$emit('saveResponses')\r\n      this.saveItem2Responses()\r\n    },\r\n    getState: function (response) {\r\n      // Si ya fue diligenciado se quita el rojo\r\n      if (response.isFilled) {\r\n        return null\r\n      } else {\r\n        return false\r\n      }\r\n    }\r\n  },\r\n  components: {\r\n    /* tag, component name */\r\n  },\r\n  computed: {\r\n    // Computed functions are called only when change the values of their related properties\r\n    completed: function () {\r\n      /* In this method we identify how many subitems have been selected */\r\n      return this.responsesList.filter(response => response.isFilled).length\r\n      // return selectedItems\r\n    },\r\n    progress: function () {\r\n      var number = (this.completed / this.totalItems) * 100\r\n      // Round the number to show only two decimals\r\n      number = number.toFixed(2)\r\n      return number\r\n    },\r\n    progressBar: function () {\r\n      return Number(this.progress)\r\n    },\r\n    ...mapGetters(['categories']) // Trae los getters del store\r\n  }\r\n}\r\n</script>\r\n<style>\r\n.table th, .table td {\r\n    vertical-align: middle;\r\n}\r\n.table thead th {\r\n    vertical-align: middle;\r\n    border-bottom: 2px solid #a4b7c1;\r\n    text-align: center\r\n}\r\n.table table td {\r\n  text-align: center\r\n}\r\n.scaleWidthResults {\r\n  width: 60%;\r\n  text-align: center\r\n}\r\n.loading {\r\n  position: fixed;\r\n  z-index: 999;\r\n  height: 2em;\r\n  width: 2em;\r\n  overflow: show;\r\n  margin: auto;\r\n  top: 0;\r\n  left: 0;\r\n  bottom: 0;\r\n  right: 0;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/BusinessLogic/TheMainInstrumentTablesItems.vue","function injectStyle (context) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"optionsId\\\":\\\"0\\\",\\\"vue\\\":true,\\\"scoped\\\":false,\\\"sourceMap\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./TheMainInstrumentTablesItems.vue\")\n}\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./TheMainInstrumentTablesItems.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./TheMainInstrumentTablesItems.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-dd00a554\\\",\\\"hasScoped\\\":false,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./TheMainInstrumentTablesItems.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../../../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/BusinessLogic/TheMainInstrumentTablesItems.vue\n// module id = null\n// module chunks = ","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"animated fadeIn\"},[_c('b-card',{staticClass:\"card-body\"},[_c('b-form',{on:{\"submit\":_vm.onSubmit}},[_vm._l((_vm.responsesByCategoriesList),function(categoryAndItems){return _c('div',{key:categoryAndItems.id},[_c('b-table',{attrs:{\"hover\":_vm.hover,\"bordered\":_vm.bordered,\"small\":_vm.small,\"responsive\":\"\",\"stacked\":\"sm\",\"items\":categoryAndItems.responsesByCategory,\"fields\":_vm.fields,\"current-page\":_vm.currentPage,\"per-page\":_vm.perPage,\"caption-top\":\"\"},scopedSlots:_vm._u([{key:\"item_order\",fn:function(data){return [_c('small',[_vm._v(_vm._s(data.item.item.item.item_order))])]}},{key:\"component\",fn:function(data){return [(data.item.item.item.component != null)?_c('span',[_vm._v(_vm._s(data.item.item.item.component.name)+\" \")]):_vm._e(),_vm._v(\" \"),(data.item.item.item.component == null)?_c('span',[_vm._v(\" -- \")]):_vm._e()]}},{key:\"dimension\",fn:function(data){return [_vm._v(\"\\r\\n          \"+_vm._s(data.item.item.item.dimension.name)+\"\\r\\n        \")]}},{key:\"name\",fn:function(data){return [_c('div',{staticClass:\"mx-auto\",attrs:{\"fluid\":\"\"}},[_vm._v(\"\\r\\n            \"+_vm._s(data.item.item.name)+\"\\r\\n          \")])]}},{key:\"responseFormat\",fn:function(data){return [_c('div',[_c('b-form-radio-group',{attrs:{\"required\":\"\",\"name\":'likertScale'+data.item.item_id.toString(),\"id\":'likertScale'+data.item.item_id.toString(),\"state\":_vm.getState(data.item)},on:{\"change\":function($event){_vm.addProgress(data.item)}},model:{value:(data.item.answer_numeric),callback:function ($$v) {_vm.$set(data.item, \"answer_numeric\", $$v)},expression:\"data.item.answer_numeric\"}},_vm._l((_vm.appliesLikertOptions),function(value,key){return _c('div',{key:key,staticClass:\"custom-control-inline py-0\"},[_c('b-form-radio',{attrs:{\"value\":value.value}},[_c('small',[_vm._v(_vm._s(value.text))])])],1)}))],1)]}}])},[_c('template',{slot:\"table-caption\"},[_c('div',{staticClass:\"float-right\"},[_c('small',[_vm._v(_vm._s(_vm.$t('message.general_progress')))]),_vm._v(\" \"),_c('i',{staticClass:\"fa fa-battery-2\"}),_vm._v(\" \"),_c('span',{staticClass:\"value\"},[_vm._v(_vm._s(_vm.completed)+\"/ \"+_vm._s(_vm.totalItems)+\" \"),_c('span',{staticClass:\"text-muted small\"},[_vm._v(_vm._s(_vm.progress)+\"%\")])]),_vm._v(\" \"),_c('div',{staticClass:\"bars\"},[_c('b-progress',{staticClass:\"progress-xs\",attrs:{\"value\":_vm.progressBar,\"variant\":\"info\"}})],1)]),_vm._v(\" \"),_c('div',{staticClass:\"h5 text-primary mb-0 mt-2 text-uppercase\"},[_vm._v(_vm._s(categoryAndItems.category.name)+\"  \"),_c('small',[_vm._v(\" \"+_vm._s(categoryAndItems.responsesCount)+\"/\"+_vm._s(categoryAndItems.responsesByCategory.length)+\" \")])]),_vm._v(\" \"),_c('div',{staticClass:\"float\"},[(categoryAndItems.allFilled)?_c('b-badge',{attrs:{\"variant\":\"dark\",\"pill\":\"\"}},[_vm._v(_vm._s(_vm.$t('message.all_fill')))]):_vm._e()],1),_vm._v(\" \"),_c('div',{staticClass:\"float\"},[_c('b-progress',{staticClass:\"mb-2\",attrs:{\"value\":categoryAndItems.progressReponses,\"variant\":\"info\",\"striped\":\"\"}})],1)])],2),_vm._v(\" \"),_c('nav')],1)}),_vm._v(\" \"),_c('b-row',[_c('b-col',{attrs:{\"md\":\"12\"}},[_c('div',{staticClass:\"float-right\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('b-button',{attrs:{\"type\":\"submit\",\"size\":\"m\",\"variant\":\"primary\"}},[_c('i',{staticClass:\"fa fa-dot-circle-o\"}),_vm._v(\" \"+_vm._s(_vm.$t(\"message.save\"))+\"\\r\\n        \")])],1)])],1)],2)],1)],1)}\nvar staticRenderFns = []\nexport { render, staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-dd00a554\",\"hasScoped\":false,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/BusinessLogic/TheMainInstrumentTablesItems.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}