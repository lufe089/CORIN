{"version":3,"sources":["webpack:///./node_modules/babel-runtime/core-js/get-iterator.js","webpack:///./node_modules/core-js/library/modules/es6.object.keys.js","webpack:///node_modules/vue-json-excel/JsonExcel.vue","webpack:///./node_modules/vue-json-excel/JsonExcel.vue","webpack:///./node_modules/vue-json-excel/JsonExcel.vue?14a3","webpack:///./node_modules/babel-runtime/core-js/object/keys.js","webpack:///./node_modules/core-js/library/fn/get-iterator.js","webpack:///./node_modules/core-js/library/modules/core.get-iterator.js","webpack:///./node_modules/core-js/library/fn/object/keys.js","webpack:///./node_modules/downloadjs/download.js","webpack:///./node_modules/core-js/library/modules/_object-sap.js"],"names":["module","exports","default","__webpack_require__","__esModule","toObject","$keys","it","JsonExcel","props","type","String","data","Array","required","fields","Object","exportFields","defaultValue","title","footer","name","fetch","Function","meta","computed","idName","Date","getTime","downloadFields","undefined","this","methods","generate","_this","asyncToGenerator_default","regenerator_default","a","mark","_callee","json","wrap","_context","prev","next","sent","length","abrupt","getProcessedJson","export","jsonToXLS","replace","jsonToCSV","stop","filename","mime","blob","base64ToBlob","download_default","xlsData","colspan","keys_default","key","parseExtraData","map","item","index","_key","csvData","push","pop","_key2","escapedCSV","match","join","header","keys","getKeys","newData","_self","newItem","label","property","getValue","extraData","format","parseData","isArray","i","field","typeof_default","indexes","split","value","getValueFromNestedItem","parseValue","hasOwnProperty","getValueFromCallback","callback","nestedItem","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","get_iterator_default","done","err","return","base64","window","btoa","unescape","encodeURIComponent","bstr","atob","n","u8arr","Uint8ClampedArray","charCodeAt","Blob","Component","component_normalizer","_h","$createElement","_c","attrs","id","on","click","_t","_v","_s","__webpack_exports__","anObject","get","getIterator","iterFn","TypeError","call","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","download","strFileName","strMimeType","reader","self","defaultMime","mimeType","payload","url","anchor","document","createElement","toString","myBlob","MozBlob","WebKitBlob","fileName","bind","href","indexOf","ajax","XMLHttpRequest","open","responseType","onload","e","target","response","setTimeout","send","test","navigator","msSaveBlob","dataUrlToBlob","saver","tempUiArr","Uint8Array","mx","strUrl","parts","binData","decodeURIComponent","uiArr","winMode","setAttribute","className","innerHTML","style","display","body","appendChild","removeChild","URL","revokeObjectURL","userAgent","confirm","location","f","src","createObjectURL","constructor","y","FileReader","result","readAsDataURL","apply","$export","core","fails","KEY","exec","fn","exp","S","F"],"mappings":"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","file":"static/js/12.971b7d93062db1feefe6.js","sourcesContent":["module.exports = { \"default\": require(\"core-js/library/fn/get-iterator\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/get-iterator.js\n// module id = BO1k\n// module chunks = 12","// 19.1.2.14 Object.keys(O)\nvar toObject = require('./_to-object');\nvar $keys = require('./_object-keys');\n\nrequire('./_object-sap')('keys', function () {\n  return function keys(it) {\n    return $keys(toObject(it));\n  };\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/es6.object.keys.js\n// module id = Cdx3\n// module chunks = 12","<template>\r\n\t<div\r\n\t\t:id=\"idName\"\r\n\t\t@click=\"generate\">\r\n\t\t<slot>\r\n\t\t\tDownload {{name}}\r\n\t\t</slot>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport download from \"downloadjs\";\r\n\r\nexport default {\r\n  props: {\r\n    // mime type [xls, csv]\r\n    type: {\r\n      type: String,\r\n      default: \"xls\"\r\n    },\r\n    // Json to download\r\n    data: {\r\n      type: Array,\r\n      required: false,\r\n      default: null\r\n    },\r\n    // fields inside the Json Object that you want to export\r\n    // if no given, all the properties in the Json are exported\r\n    fields: {\r\n      type: Object,\r\n      required: false\r\n    },\r\n    // this prop is used to fix the problem with other components that use the\r\n    // variable fields, like vee-validate. exportFields works exactly like fields\r\n    exportFields: {\r\n      type: Object,\r\n      required: false\r\n    },\r\n    // Use as fallback when the row has no field values\r\n    defaultValue: {\r\n      type: String,\r\n      required: false,\r\n      default: \"\"\r\n    },\r\n    // Title(s) for the data, could be a string or an array of strings (multiple titles)\r\n    title: {\r\n      default: null\r\n    },\r\n    // Footer(s) for the data, could be a string or an array of strings (multiple footers)\r\n    footer: {\r\n      default: null\r\n    },\r\n    // filename to export\r\n    name: {\r\n      type: String,\r\n      default: \"data.xls\"\r\n    },\r\n    fetch: {\r\n      type: Function,\r\n    },\r\n    meta: {\r\n      type: Array,\r\n      default: () => []\r\n    }\r\n  },\r\n  computed: {\r\n    // unique identifier\r\n    idName() {\r\n      var now = new Date().getTime();\r\n      return \"export_\" + now;\r\n    },\r\n\r\n    downloadFields() {\r\n      if (this.fields !== undefined) return this.fields;\r\n\r\n      if (this.exportFields !== undefined) return this.exportFields;\r\n    }\r\n  },\r\n  methods: {\r\n    async generate() {\r\n      let data = this.data;\r\n      if(typeof this.fetch === 'function' || !data)\r\n         data = await this.fetch();\r\n\r\n      if (!data || !data.length) {\r\n        return;\r\n      }\r\n\r\n      let json = this.getProcessedJson(data, this.downloadFields);\r\n      if (this.type === \"html\") {\r\n        // this is mainly for testing\r\n        return this.export(\r\n          this.jsonToXLS(json),\r\n          this.name.replace(\".xls\", \".html\"),\r\n          \"text/html\"\r\n        );\r\n      } else if (this.type === \"csv\") {\r\n        return this.export(\r\n          this.jsonToCSV(json),\r\n          this.name.replace(\".xls\", \".csv\"),\r\n          \"application/csv\"\r\n        );\r\n      }\r\n      return this.export(\r\n        this.jsonToXLS(json),\r\n        this.name,\r\n        \"application/vnd.ms-excel\"\r\n      );\r\n    },\r\n    /*\r\n\t\tUse downloadjs to generate the download link\r\n\t\t*/\r\n    export(data, filename, mime) {\r\n      let blob = this.base64ToBlob(data, mime);\r\n      download(blob, filename, mime);\r\n    },\r\n    /*\r\n\t\tjsonToXLS\r\n\t\t---------------\r\n\t\tTransform json data into an xml document with MS Excel format, sadly\r\n\t\tit shows a prompt when it opens, that is a default behavior for\r\n\t\tMicrosoft office and cannot be avoided. It's recommended to use CSV format instead.\r\n\t\t*/\r\n    jsonToXLS(data) {\r\n      let xlsTemp =\r\n        '<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content=\"Microsoft Excel 11\"><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>${table}</table></body></html>';\r\n      let xlsData = \"<thead>\";\r\n      const colspan = Object.keys(data[0]).length;\r\n\r\n      //Header\r\n      if (this.title != null) {\r\n        xlsData += this.parseExtraData(\r\n          this.title,\r\n          '<tr><th colspan=\"' + colspan + '\">${data}</th></tr>'\r\n        );\r\n      }\r\n\r\n      //Fields\r\n      xlsData += \"<tr>\";\r\n      for (let key in data[0]) {\r\n        xlsData += \"<th>\" + key + \"</th>\";\r\n      }\r\n      xlsData += \"</tr>\";\r\n      xlsData += \"</thead>\";\r\n\r\n      //Data\r\n      xlsData += \"<tbody>\";\r\n      data.map(function(item, index) {\r\n        xlsData += \"<tr>\";\r\n        for (let key in item) {\r\n          xlsData += \"<td>\" + item[key] + \"</td>\";\r\n        }\r\n        xlsData += \"</tr>\";\r\n      });\r\n      xlsData += \"</tbody>\";\r\n\r\n      //Footer\r\n      if (this.footer != null) {\r\n        xlsData += \"<tfoot>\";\r\n        xlsData += this.parseExtraData(\r\n          this.footer,\r\n          '<tr><td colspan=\"' + colspan + '\">${data}</td></tr>'\r\n        );\r\n        xlsData += \"</tfoot>\";\r\n      }\r\n\r\n      return xlsTemp.replace(\"${table}\", xlsData);\r\n    },\r\n    /*\r\n\t\tjsonToCSV\r\n\t\t---------------\r\n\t\tTransform json data into an CSV file.\r\n\t\t*/\r\n    jsonToCSV(data) {\r\n      var csvData = [];\r\n      //Header\r\n      if (this.title != null) {\r\n        csvData.push(this.parseExtraData(this.title, \"${data}\\r\\n\"));\r\n      }\r\n      //Fields\r\n      for (let key in data[0]) {\r\n        csvData.push(key);\r\n        csvData.push(\",\");\r\n      }\r\n      csvData.pop();\r\n      csvData.push(\"\\r\\n\");\r\n      //Data\r\n      data.map(function(item) {\r\n        for (let key in item) {\r\n          let escapedCSV = item[key] + \"\"; // cast Numbers to string\r\n          if (escapedCSV.match(/[,\"\\n]/)) {\r\n            escapedCSV = '\"' + escapedCSV.replace(/\\\"/g, '\"\"') + '\"';\r\n          }\r\n          csvData.push(escapedCSV);\r\n          csvData.push(\",\");\r\n        }\r\n        csvData.pop();\r\n        csvData.push(\"\\r\\n\");\r\n      });\r\n      //Footer\r\n      if (this.footer != null) {\r\n        csvData.push(this.parseExtraData(this.footer, \"${data}\\r\\n\"));\r\n      }\r\n      return csvData.join(\"\");\r\n    },\r\n    /*\r\n\t\tgetProcessedJson\r\n\t\t---------------\r\n\t\tGet only the data to export, if no fields are set return all the data\r\n\t\t*/\r\n    getProcessedJson(data, header) {\r\n      let keys = this.getKeys(data, header);\r\n      let newData = [];\r\n      let _self = this;\r\n      data.map(function(item, index) {\r\n        let newItem = {};\r\n        for (let label in keys) {\r\n          let property = keys[label];\r\n          newItem[label] = _self.getValue(property, item);\r\n        }\r\n        newData.push(newItem);\r\n      });\r\n\r\n      return newData;\r\n    },\r\n    getKeys(data, header) {\r\n      if (header) {\r\n        return header;\r\n      }\r\n\r\n      let keys = {};\r\n      for (let key in data[0]) {\r\n        keys[key] = key;\r\n      }\r\n      return keys;\r\n    },\r\n    /*\r\n\t\tparseExtraData\r\n\t\t---------------\r\n\t\tParse title and footer attribute to the csv format\r\n\t\t*/\r\n    parseExtraData(extraData, format) {\r\n      let parseData = \"\";\r\n      if (Array.isArray(extraData)) {\r\n        for (var i = 0; i < extraData.length; i++) {\r\n          parseData += format.replace(\"${data}\", extraData[i]);\r\n        }\r\n      } else {\r\n        parseData += format.replace(\"${data}\", extraData);\r\n      }\r\n      return parseData;\r\n    },\r\n\r\n    getValue(key, item) {\r\n      const field = typeof key   !== \"object\" ? key : key.field;\r\n      let indexes = typeof field !== \"string\" ? []  : field.split(\".\");\r\n      let value   = this.defaultValue;\r\n    \r\n      if (!field)\r\n\t      value = item;\r\n      else if( indexes.length > 1 )\r\n        value = this.getValueFromNestedItem(item, indexes);\r\n      else\r\n        value = this.parseValue(item[field]);\r\n      \r\n      if( key.hasOwnProperty('callback'))\r\n        value = this.getValueFromCallback(value, key.callback);\r\n      \r\n      return value;\r\n    },\r\n\r\n    getValueFromNestedItem(item, indexes){\r\n      let nestedItem = item;\r\n      for (let index of indexes) {\r\n        if(nestedItem)\r\n          nestedItem = nestedItem[index];\r\n      }\r\n      return this.parseValue(nestedItem);\r\n    },\r\n\r\n    getValueFromCallback(item, callback){\r\n      if(typeof callback !== \"function\")\r\n        return this.defaultValue\r\n      const value = callback(item);\r\n      return this.parseValue(value);\r\n    },\r\n    parseValue(value){\r\n      return value || value === 0 \r\n          ? value\r\n          : this.defaultValue;\r\n    },\r\n    base64ToBlob(data, mime) {\r\n      let base64 = window.btoa(window.unescape(encodeURIComponent(data)));\r\n      let bstr = atob(base64);\r\n      let n = bstr.length;\r\n      let u8arr = new Uint8ClampedArray(n);\r\n      while (n--) {\r\n        u8arr[n] = bstr.charCodeAt(n);\r\n      }\r\n      return new Blob([u8arr], { type: mime });\r\n    }\r\n  } // end methods\r\n};\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// node_modules/vue-json-excel/JsonExcel.vue","/* script */\nexport * from \"!!babel-loader!../vue-loader/lib/selector?type=script&index=0!./JsonExcel.vue\"\nimport __vue_script__ from \"!!babel-loader!../vue-loader/lib/selector?type=script&index=0!./JsonExcel.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-cdff216a\\\",\\\"hasScoped\\\":false,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../vue-loader/lib/selector?type=template&index=0!./JsonExcel.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-json-excel/JsonExcel.vue\n// module id = null\n// module chunks = ","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":_vm.idName},on:{\"click\":_vm.generate}},[_vm._t(\"default\",[_vm._v(\"\\n\\t\\tDownload \"+_vm._s(_vm.name)+\"\\n\\t\")])],2)}\nvar staticRenderFns = []\nexport { render, staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-cdff216a\",\"hasScoped\":false,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./node_modules/vue-json-excel/JsonExcel.vue\n// module id = null\n// module chunks = ","module.exports = { \"default\": require(\"core-js/library/fn/object/keys\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/object/keys.js\n// module id = fZjL\n// module chunks = 12","require('../modules/web.dom.iterable');\nrequire('../modules/es6.string.iterator');\nmodule.exports = require('../modules/core.get-iterator');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/get-iterator.js\n// module id = fxRn\n// module chunks = 12","var anObject = require('./_an-object');\nvar get = require('./core.get-iterator-method');\nmodule.exports = require('./_core').getIterator = function (it) {\n  var iterFn = get(it);\n  if (typeof iterFn != 'function') throw TypeError(it + ' is not iterable!');\n  return anObject(iterFn.call(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/core.get-iterator.js\n// module id = g8Ux\n// module chunks = 12","require('../../modules/es6.object.keys');\nmodule.exports = require('../../modules/_core').Object.keys;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/object/keys.js\n// module id = jFbC\n// module chunks = 12","//download.js v4.2, by dandavis; 2008-2016. [MIT] see http://danml.com/download.html for tests/usage\n// v1 landed a FF+Chrome compat way of downloading strings to local un-named files, upgraded to use a hidden frame and optional mime\n// v2 added named files via a[download], msSaveBlob, IE (10+) support, and window.URL support for larger+faster saves than dataURLs\n// v3 added dataURL and Blob Input, bind-toggle arity, and legacy dataURL fallback was improved with force-download mime and base64 support. 3.1 improved safari handling.\n// v4 adds AMD/UMD, commonJS, and plain browser support\n// v4.1 adds url download capability via solo URL argument (same domain/CORS only)\n// v4.2 adds semantic variable names, long (over 2MB) dataURL support, and hidden by default temp anchors\n// https://github.com/rndme/download\n\n(function (root, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine([], factory);\n\t} else if (typeof exports === 'object') {\n\t\t// Node. Does not work with strict CommonJS, but\n\t\t// only CommonJS-like environments that support module.exports,\n\t\t// like Node.\n\t\tmodule.exports = factory();\n\t} else {\n\t\t// Browser globals (root is window)\n\t\troot.download = factory();\n  }\n}(this, function () {\n\n\treturn function download(data, strFileName, strMimeType) {\n\n\t\tvar self = window, // this script is only for browsers anyway...\n\t\t\tdefaultMime = \"application/octet-stream\", // this default mime also triggers iframe downloads\n\t\t\tmimeType = strMimeType || defaultMime,\n\t\t\tpayload = data,\n\t\t\turl = !strFileName && !strMimeType && payload,\n\t\t\tanchor = document.createElement(\"a\"),\n\t\t\ttoString = function(a){return String(a);},\n\t\t\tmyBlob = (self.Blob || self.MozBlob || self.WebKitBlob || toString),\n\t\t\tfileName = strFileName || \"download\",\n\t\t\tblob,\n\t\t\treader;\n\t\t\tmyBlob= myBlob.call ? myBlob.bind(self) : Blob ;\n\t  \n\t\tif(String(this)===\"true\"){ //reverse arguments, allowing download.bind(true, \"text/xml\", \"export.xml\") to act as a callback\n\t\t\tpayload=[payload, mimeType];\n\t\t\tmimeType=payload[0];\n\t\t\tpayload=payload[1];\n\t\t}\n\n\n\t\tif(url && url.length< 2048){ // if no filename and no mime, assume a url was passed as the only argument\n\t\t\tfileName = url.split(\"/\").pop().split(\"?\")[0];\n\t\t\tanchor.href = url; // assign href prop to temp anchor\n\t\t  \tif(anchor.href.indexOf(url) !== -1){ // if the browser determines that it's a potentially valid url path:\n        \t\tvar ajax=new XMLHttpRequest();\n        \t\tajax.open( \"GET\", url, true);\n        \t\tajax.responseType = 'blob';\n        \t\tajax.onload= function(e){ \n\t\t\t\t  download(e.target.response, fileName, defaultMime);\n\t\t\t\t};\n        \t\tsetTimeout(function(){ ajax.send();}, 0); // allows setting custom ajax headers using the return:\n\t\t\t    return ajax;\n\t\t\t} // end if valid url?\n\t\t} // end if url?\n\n\n\t\t//go ahead and download dataURLs right away\n\t\tif(/^data:([\\w+-]+\\/[\\w+.-]+)?[,;]/.test(payload)){\n\t\t\n\t\t\tif(payload.length > (1024*1024*1.999) && myBlob !== toString ){\n\t\t\t\tpayload=dataUrlToBlob(payload);\n\t\t\t\tmimeType=payload.type || defaultMime;\n\t\t\t}else{\t\t\t\n\t\t\t\treturn navigator.msSaveBlob ?  // IE10 can't do a[download], only Blobs:\n\t\t\t\t\tnavigator.msSaveBlob(dataUrlToBlob(payload), fileName) :\n\t\t\t\t\tsaver(payload) ; // everyone else can save dataURLs un-processed\n\t\t\t}\n\t\t\t\n\t\t}else{//not data url, is it a string with special needs?\n\t\t\tif(/([\\x80-\\xff])/.test(payload)){\t\t\t  \n\t\t\t\tvar i=0, tempUiArr= new Uint8Array(payload.length), mx=tempUiArr.length;\n\t\t\t\tfor(i;i<mx;++i) tempUiArr[i]= payload.charCodeAt(i);\n\t\t\t \tpayload=new myBlob([tempUiArr], {type: mimeType});\n\t\t\t}\t\t  \n\t\t}\n\t\tblob = payload instanceof myBlob ?\n\t\t\tpayload :\n\t\t\tnew myBlob([payload], {type: mimeType}) ;\n\n\n\t\tfunction dataUrlToBlob(strUrl) {\n\t\t\tvar parts= strUrl.split(/[:;,]/),\n\t\t\ttype= parts[1],\n\t\t\tdecoder= parts[2] == \"base64\" ? atob : decodeURIComponent,\n\t\t\tbinData= decoder( parts.pop() ),\n\t\t\tmx= binData.length,\n\t\t\ti= 0,\n\t\t\tuiArr= new Uint8Array(mx);\n\n\t\t\tfor(i;i<mx;++i) uiArr[i]= binData.charCodeAt(i);\n\n\t\t\treturn new myBlob([uiArr], {type: type});\n\t\t }\n\n\t\tfunction saver(url, winMode){\n\n\t\t\tif ('download' in anchor) { //html5 A[download]\n\t\t\t\tanchor.href = url;\n\t\t\t\tanchor.setAttribute(\"download\", fileName);\n\t\t\t\tanchor.className = \"download-js-link\";\n\t\t\t\tanchor.innerHTML = \"downloading...\";\n\t\t\t\tanchor.style.display = \"none\";\n\t\t\t\tdocument.body.appendChild(anchor);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tanchor.click();\n\t\t\t\t\tdocument.body.removeChild(anchor);\n\t\t\t\t\tif(winMode===true){setTimeout(function(){ self.URL.revokeObjectURL(anchor.href);}, 250 );}\n\t\t\t\t}, 66);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// handle non-a[download] safari as best we can:\n\t\t\tif(/(Version)\\/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari\\//.test(navigator.userAgent)) {\n\t\t\t\tif(/^data:/.test(url))\turl=\"data:\"+url.replace(/^data:([\\w\\/\\-\\+]+)/, defaultMime);\n\t\t\t\tif(!window.open(url)){ // popup blocked, offer direct download:\n\t\t\t\t\tif(confirm(\"Displaying New Document\\n\\nUse Save As... to download, then click back to return to this page.\")){ location.href=url; }\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t//do iframe dataURL download (old ch+FF):\n\t\t\tvar f = document.createElement(\"iframe\");\n\t\t\tdocument.body.appendChild(f);\n\n\t\t\tif(!winMode && /^data:/.test(url)){ // force a mime that will download:\n\t\t\t\turl=\"data:\"+url.replace(/^data:([\\w\\/\\-\\+]+)/, defaultMime);\n\t\t\t}\n\t\t\tf.src=url;\n\t\t\tsetTimeout(function(){ document.body.removeChild(f); }, 333);\n\n\t\t}//end saver\n\n\n\n\n\t\tif (navigator.msSaveBlob) { // IE10+ : (has Blob, but not a[download] or URL)\n\t\t\treturn navigator.msSaveBlob(blob, fileName);\n\t\t}\n\n\t\tif(self.URL){ // simple fast and modern way using Blob and URL:\n\t\t\tsaver(self.URL.createObjectURL(blob), true);\n\t\t}else{\n\t\t\t// handle non-Blob()+non-URL browsers:\n\t\t\tif(typeof blob === \"string\" || blob.constructor===toString ){\n\t\t\t\ttry{\n\t\t\t\t\treturn saver( \"data:\" +  mimeType   + \";base64,\"  +  self.btoa(blob)  );\n\t\t\t\t}catch(y){\n\t\t\t\t\treturn saver( \"data:\" +  mimeType   + \",\" + encodeURIComponent(blob)  );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Blob but not URL support:\n\t\t\treader=new FileReader();\n\t\t\treader.onload=function(e){\n\t\t\t\tsaver(this.result);\n\t\t\t};\n\t\t\treader.readAsDataURL(blob);\n\t\t}\n\t\treturn true;\n\t}; /* end download() */\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/downloadjs/download.js\n// module id = sJst\n// module chunks = 12","// most Object methods by ES6 should accept primitives\nvar $export = require('./_export');\nvar core = require('./_core');\nvar fails = require('./_fails');\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/modules/_object-sap.js\n// module id = uqUo\n// module chunks = 12"],"sourceRoot":""}