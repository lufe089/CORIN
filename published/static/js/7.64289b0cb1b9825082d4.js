webpackJsonp([7],{"6JgH":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("mvHQ"),a=s.n(n),i=s("Dd8w"),r=s.n(i),o=s("Xxa5"),l=s.n(o),c=s("exGp"),d=s.n(c),m=s("d+r2"),u=s("lHQJ"),p=s("H/Zg"),f=s("6doq"),_=s("NYxO"),v=s("AezD"),C={name:"results-module",components:{DownloadExcel:function(){return s.e(12).then(s.bind(null,"fXhN"))},clientSelector:function(){return s.e(0).then(s.bind(null,"AxsP"))}},data:function(){return{exportFileNames:m.a.exportFileNames,idClient:null,idCompany:null,showInfoMessage:!1,clients:[],json_fields_items:{Pregunta_id:"id","Descripción":"name","Dimensión":"item.dimension.name","Categoría":"item.category.name",Componente:{field:"item.component",callback:function(e){return""===e?"----":e.name}}},json_fields_clients:{Cliente:"client_company_name","Identificación":"identification","Año de constitución":"constitution_year","Número de empleados":"number_employees","Grupo coorporativo?":{field:"is_corporate_group",callback:function(e){return""===e?f.a.tc("message.no"):f.a.tc("message.yes")}},"Grupo familiar?":{field:"is_family_company",callback:function(e){return""===e?f.a.tc("message.no"):f.a.tc("message.yes")}},"Número máximo de encuestas":"max_surveys","Encuestas aplicadas":"used_surveys"},json_fields_responses:{Pregunta_id:"pregunta_id",Respuesta:"answer_numeric",Participante_id:"participant_id",Email:"participant_email","Área":"area","Directivo?":{field:"is_directive",callback:function(e){return""===e?f.a.tc("message.no"):f.a.tc("message.yes")}},Cliente_id:"client_id",Cliente_nombre:"client_name"},json_meta:[[{key:"charset",value:"utf-8"}]]}},mounted:function(){var e=this;return d()(l.a.mark(function t(){var s,n;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.$store.commit(v.a),!e.isClient){t.next=6;break}e.idClient=e.currentUser.client_id,e.idCompany=e.currentUser.company_id,t.next=39;break;case 6:if(!e.isCompany){t.next=19;break}return e.idCompany=e.currentUser.company_id,e.idClient=null,(s={}).idCompany=e.currentUser.company_id,s.isClient=e.isClient,s.isAdmin=e.isAdmin,s.isCompany=e.isCompany,t.next=16,e.consult(s,m.a.endPoints.urlClients,"post");case 16:e.clients=t.sent,t.next=39;break;case 19:if(!e.isAdmin){t.next=39;break}return e.idCompany=null,e.idClient=null,(n={}).idCompany=e.idCompany,n.isClient=e.isClient,n.isAdmin=e.isAdmin,n.isCompany=e.isCompany,t.prev=27,t.next=30,e.$store.dispatch(u.e);case 30:t.next=36;break;case 32:t.prev=32,t.t0=t.catch(27),e.$store.commit(v.j,t.t0.message),e.$store.commit(v.k,!1);case 36:return t.next=38,e.consult(n,m.a.endPoints.urlClients,"post");case 38:e.clients=t.sent;case 39:case"end":return t.stop()}},t,e,[[27,32]])}))()},watch:{},computed:r()({},Object(_.b)(["isAdmin","isCompany","isParticipant","isClient","hasErrors","currentUser","companies"])),methods:{changeClientAnswers:function(e){this.idClient=this.currentUser.client_id,this.showInfoMessage=!1},consult:function(e,t){var s=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"post";return d()(l.a.mark(function i(){var r;return l.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,s.showInfoMessage=!1,r=null,s.$store.commit(v.k,!0),"post"!==n){i.next=10;break}return i.next=7,p.a.post(e,t);case 7:r=i.sent,i.next=14;break;case 10:if("get"!==n){i.next=14;break}return i.next=13,p.a.getAll(t);case 13:r=i.sent;case 14:return s.$store.commit(v.k,!1),0===r.data.length&&(s.showInfoMessage=!0),i.abrupt("return",r.data);case 19:i.prev=19,i.t0=i.catch(0),console.error(a()(i.t0.message)),s.$store.commit(v.j,i.t0.message),s.$store.commit(v.k,!1);case 24:case"end":return i.stop()}},i,s,[[0,19]])}))()},exportItems:function(){var e=this;return d()(l.a.mark(function t(){var s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.consult({},m.a.endPoints.urlActiveItems,"get");case 2:return s=t.sent,t.abrupt("return",s);case 4:case"end":return t.stop()}},t,e)}))()},exportClients:function(){var e=this;return d()(l.a.mark(function t(){var s,n;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s={},e.isAdmin?s.idCompany=null:e.isCompany&&(s.idCompany=e.currentUser.company_id),s.isClient=e.isClient,s.isAdmin=e.isAdmin,s.isCompany=e.isCompany,t.next=7,e.consult(s,m.a.endPoints.urlClients);case 7:return n=t.sent,t.abrupt("return",n);case 9:case"end":return t.stop()}},t,e)}))()},exportResponses:function(){var e=this;return d()(l.a.mark(function t(){var s,n;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return(s={}).idClient=e.idClient,s.idCompany=e.idCompany,s.isClient=e.isClient,s.isAdmin=e.isAdmin,s.isCompany=e.isCompany,t.next=8,e.consult(s,m.a.endPoints.urlResponses);case 8:if(0!==(n=t.sent).length){t.next=14;break}return console.error("ningun resultado"),t.abrupt("return",[]);case 14:return t.abrupt("return",n);case 15:case"end":return t.stop()}},t,e)}))()},refresh:function(){this.showInfoMessage=!1}}},g=s("XyMi"),b=Object(g.a)(C,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("b-card",[s("div",{attrs:{slot:"header"},slot:"header"},[s("b-row",[s("b-col",{attrs:{md:"12"}},[s("strong",[e._v(e._s(e.$t("message.download_data")))])])],1)],1),e._v(" "),s("b-row",{attrs:{md:"12"}},[s("b-col",{attrs:{lg:"12"}},[s("b-card",{directives:[{name:"show",rawName:"v-show",value:e.showInfoMessage,expression:"showInfoMessage"}],attrs:{"header-tag":"header","footer-tag":"footer"}},[s("b-alert",{attrs:{show:"",variant:"info"}},[s("h4",{staticClass:"alert-heading"},[e._v(e._s(e.$t("message.download_no_data_title")))]),e._v(" "),s("hr"),e._v(" "),s("p",[e._v("\n                    "+e._s(e.$t("message.download_no_data"))+"\n                  ")])])],1)],1)],1),e._v(" "),s("b-row",{attrs:{fluid:""}},[s("b-col",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}],attrs:{md:"12"}},[s("b-list-group",[s("b-list-group-item",{staticClass:"d-flex justify-content-center",attrs:{variant:"secondary"}},[s("div",{staticClass:"font-weight-bold font-lg"},[e._v(" "+e._s(e.$t("message.download_parametric_data"))+" ")])]),e._v(" "),s("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center",attrs:{button:""}},[e._v("\n            "+e._s(e.$t("message.items"))+"\n            "),s("download-excel",{attrs:{fetch:e.exportItems,fields:e.json_fields_items,name:e.exportFileNames.items}},[s("a",{attrs:{href:"#"}},[s("i",{staticClass:"fa fa-download fa-lg mt-4"})])])],1)],1)],1),e._v(" "),s("b-col",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin||e.isCompany,expression:"isAdmin || isCompany"}],attrs:{md:"12"}},[s("b-list-group",[s("b-list-group-item",{staticClass:"d-flex justify-content-center",attrs:{variant:"secondary"}},[s("div",{staticClass:"font-weight-bold font-lg"},[e._v(" "+e._s(e.$t("message.download_clients"))+" ")])]),e._v(" "),s("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center",attrs:{button:""}},[s("b-input-group",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}],staticClass:"mb-12"},[s("b-input-group-prepend",[s("b-input-group-text",[s("i",{staticClass:"icon-grid"})])],1),e._v(" "),s("b-form-select",{attrs:{options:e.companies,"value-field":"id","text-field":"name"},model:{value:e.idCompany,callback:function(t){e.idCompany=t},expression:"idCompany"}},[s("template",{slot:"first"},[s("option",{domProps:{value:null}},[e._v(e._s(e.$t("message.seleccion_compania")))])])],2)],1),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:null!=e.idCompany,expression:"idCompany != null"}],staticClass:"mb-12"},[e._v("\n              "+e._s(e.$t("message.clients"))+"\n             "),s("download-excel",{attrs:{fields:e.json_fields_clients,fetch:e.exportClients,name:e.exportFileNames.clients}},[s("a",{attrs:{href:"#"}},[s("i",{staticClass:"fa fa-download fa-lg mt-4"})])])],1)],1)],1)],1)],1),e._v(" "),s("b-row",{attrs:{fluid:""}},[s("b-col",{attrs:{md:"12"}},[s("b-list-group",[s("b-list-group-item",{staticClass:"d-flex justify-content-center",attrs:{variant:"secondary"}},[s("div",{staticClass:"font-weight-bold font-lg"},[e._v(" "+e._s(e.$t("message.download_answers_data"))+" ")])])],1),e._v(" "),s("b-list-group",[s("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center",attrs:{button:""}},[s("b-row",[s("b-col",{attrs:{md:"12"}},[s("b-input-group",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin||e.isCompany,expression:"isAdmin || isCompany"}],staticClass:"mb-12"},[s("b-input-group-prepend",[s("b-input-group-text",[s("i",{staticClass:"icon-grid"})])],1),e._v(" "),s("b-form-select",{attrs:{options:e.clients,"value-field":"id","text-field":"client_company_name"},on:{change:e.refresh},model:{value:e.idClient,callback:function(t){e.idClient=t},expression:"idClient"}},[s("template",{slot:"first"},[s("option",{domProps:{value:null}},[e._v(e._s(e.$t("message.seleccion_cliente")))])])],2)],1)],1),e._v(" "),s("b-col",{attrs:{md:"12"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:null!=e.idClient,expression:"idClient != null"}]},[e._v("\n                "+e._s(e.$t("message.download_answers_by_client_id"))+"\n                "),s("download-excel",{attrs:{fetch:e.exportResponses,fields:e.json_fields_responses,name:e.exportFileNames.responses}},[s("a",{attrs:{href:"#"}},[s("i",{staticClass:"fa fa-download fa-lg mt-4"})])])],1)])],1)],1),e._v(" "),s("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center",attrs:{button:""}},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.isAdmin,expression:"isAdmin"}]},[e._v("\n            "+e._s(e.$t("message.all"))+"\n            "),s("download-excel",{attrs:{fetch:e.exportResponses,fields:e.json_fields_responses,name:e.exportFileNames.responses}},[s("a",{attrs:{href:"#"}},[s("i",{staticClass:"fa fa-download fa-lg mt-4"})])])],1)])],1)],1)],1)],1)},[],!1,null,null,null);t.default=b.exports}});
//# sourceMappingURL=7.64289b0cb1b9825082d4.js.map