webpackJsonp([3],{"1PRI":function(e,t){},Rnzu:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("Dd8w"),a=s.n(r),n=s("Xxa5"),i=s.n(n),o=s("exGp"),l=s.n(o),m=s("d+r2"),c=s("H/Zg"),u=s("NYxO"),p=s("lHQJ"),d=s("AezD"),f={name:"the-main-instrument-tables-items",props:{caption:{type:String,default:"Table"},hover:{type:Boolean,default:!1},striped:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},small:{type:Boolean,default:!1},fixed:{type:Boolean,default:!1},improvementOptions:{type:Array,default:function(){return m.a.improvementOptions}},appliesLikertOptions:{type:Array,default:function(){return m.a.appliesLikertOptions}}},data:function(){return{responsesList:[],fields:[{key:"name",sortable:!0,label:"Item"},{key:"responseFormat",label:"Total desacuerdo (1) -- Total acuerdo (9)",class:"scaleWidthResults"}],currentPage:1,subItems:[],perPage:17,totalRows:0,totalItems:0,dataLevelTwo:[],responsesByCategoriesList:[],company:{company_contact_name:"Prueba",company_email:"luisaEmailTest"}}},mounted:function(){this.$store.commit(d.a),this.loadEmptySurvey()},methods:{getRowCount:function(e){return e.length},toggleReview:function(e){e.needReview=!e.needReview},addProgress:function(e){e.isFilled=!0,e.state=!0,this.calculateProgressByCategories()},clearLikertScale:function(e){!1===e.N_A?(e.numericAnswer=null,e.isFilled=!0):e.isFilled=!1},loadEmptySurvey:function(){var e=this;return l()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.$store.dispatch(p.c),e.$store.commit(d.k,!0),t.next=4,c.a.getAll(m.a.endPoints.itemsSpanish).then(function(t){200===t.status&&(console.log(t.data),e.subItems=t.data,e.totalItems=e.subItems.length,e.prepareData(e.categories,e.subItems),e.prepareItemResponses(),console.info("Consultados datos de los items"),e.$store.commit(d.k,!1))}).catch(function(t){e.$store.commit(d.j,t.message)}).finally(e.$store.commit(d.k,!1));case 4:case"end":return t.stop()}},t,e)}))()},prepareData:function(e,t){this.$store.commit(d.k,!0);for(var s=0;s<e.length;s++){var r={};r.category=e[s],r.responsesList=t.filter(function(t){return t.item.category.id===e[s].id}),this.dataLevelTwo.push(r)}this.$store.commit(d.k,!1)},createFakeResponses:function(e){e.answer_numeric=Math.round(10*Math.random()),(e.answer_numeric<1||e.answer_numeric>9)&&(e.answer_numeric=9),e.isFilled=!0},prepareItemResponses:function(){for(var e=0;e<this.dataLevelTwo.length;e++){for(var t,s=this.dataLevelTwo[e],r=[],a=0;a<s.responsesList.length;a++){var n={},i=s.responsesList[a].id;n.name=s.responsesList[a].name,n.item_id=i,n.item=s.responsesList[a],n.answer_numeric=null,n.isFilled=!1,n.is_complete=!0,this.createFakeResponses(n),r.push(n),this.responsesList.push(n)}t=r.length,this.responsesByCategoriesList.push({category:s.category,responsesByCategory:r,itemsByCategory:t,progressReponses:0,responsesCount:0,allFilled:!1})}},calculateProgressByCategories:function(){for(var e=0;e<this.responsesByCategoriesList.length;e++){var t=this.responsesByCategoriesList[e].responsesByCategory,s=t.length;this.responsesByCategoriesList[e].responsesCount=t.filter(function(e){return e.isFilled}).length;var r=this.responsesByCategoriesList[e].responsesCount/s;r*=100,this.responsesByCategoriesList[e].progressReponses=r,this.responsesByCategoriesList[e].responsesCount===s&&(this.responsesByCategoriesList[e].allFilled=!0)}},saveItem2Responses:function(){console.log("Guardando ..."),this.$emit("item-level2-table:change",this.responsesList)},onSubmit:function(e){e.preventDefault(),this.saveItem2Responses()},getState:function(e){return!!e.isFilled&&null}},components:{},computed:a()({completed:function(){return this.responsesList.filter(function(e){return e.isFilled}).length},progress:function(){var e=this.completed/this.totalItems*100;return e=e.toFixed(2)},progressBar:function(){return Number(this.progress)}},Object(u.b)(["categories"]))},g=s("XyMi");var v=function(e){s("1PRI")},_=Object(g.a)(f,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"animated fadeIn"},[s("b-card",{staticClass:"card-body"},[s("b-form",{on:{submit:e.onSubmit}},[e._l(e.responsesByCategoriesList,function(t){return s("div",{key:t.id},[s("b-table",{attrs:{hover:e.hover,bordered:e.bordered,small:e.small,responsive:"",stacked:"sm",items:t.responsesByCategory,fields:e.fields,"current-page":e.currentPage,"per-page":e.perPage,"caption-top":""},scopedSlots:e._u([{key:"item_order",fn:function(t){return[s("small",[e._v(e._s(t.item.item.item.item_order))])]}},{key:"component",fn:function(t){return[null!=t.item.item.item.component?s("span",[e._v(e._s(t.item.item.item.component.name)+" ")]):e._e(),e._v(" "),null==t.item.item.item.component?s("span",[e._v(" -- ")]):e._e()]}},{key:"dimension",fn:function(t){return[e._v("\r\n          "+e._s(t.item.item.item.dimension.name)+"\r\n        ")]}},{key:"name",fn:function(t){return[s("div",{staticClass:"mx-auto",attrs:{fluid:""}},[e._v("\r\n            "+e._s(t.item.item.name)+"\r\n          ")])]}},{key:"responseFormat",fn:function(t){return[s("div",[s("b-form-radio-group",{attrs:{required:"",name:"likertScale"+t.item.item_id.toString(),id:"likertScale"+t.item.item_id.toString(),state:e.getState(t.item)},on:{change:function(s){e.addProgress(t.item)}},model:{value:t.item.answer_numeric,callback:function(s){e.$set(t.item,"answer_numeric",s)},expression:"data.item.answer_numeric"}},e._l(e.appliesLikertOptions,function(t,r){return s("div",{key:r,staticClass:"custom-control-inline py-0"},[s("b-form-radio",{attrs:{value:t.value}},[s("small",[e._v(e._s(t.text))])])],1)}))],1)]}}])},[s("template",{slot:"table-caption"},[s("div",{staticClass:"float-right"},[s("small",[e._v(e._s(e.$t("message.general_progress")))]),e._v(" "),s("i",{staticClass:"fa fa-battery-2"}),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.completed)+"/ "+e._s(e.totalItems)+" "),s("span",{staticClass:"text-muted small"},[e._v(e._s(e.progress)+"%")])]),e._v(" "),s("div",{staticClass:"bars"},[s("b-progress",{staticClass:"progress-xs",attrs:{value:e.progressBar,variant:"info"}})],1)]),e._v(" "),s("div",{staticClass:"h5 text-primary mb-0 mt-2 text-uppercase"},[e._v(e._s(t.category.name)+"  "),s("small",[e._v(" "+e._s(t.responsesCount)+"/"+e._s(t.responsesByCategory.length)+" ")])]),e._v(" "),s("div",{staticClass:"float"},[t.allFilled?s("b-badge",{attrs:{variant:"dark",pill:""}},[e._v(e._s(e.$t("message.all_fill")))]):e._e()],1),e._v(" "),s("div",{staticClass:"float"},[s("b-progress",{staticClass:"mb-2",attrs:{value:t.progressReponses,variant:"info",striped:""}})],1)])],2),e._v(" "),s("nav")],1)}),e._v(" "),s("b-row",[s("b-col",{attrs:{md:"12"}},[s("div",{staticClass:"float-right",attrs:{slot:"footer"},slot:"footer"},[s("b-button",{attrs:{type:"submit",size:"m",variant:"primary"}},[s("i",{staticClass:"fa fa-dot-circle-o"}),e._v(" "+e._s(e.$t("message.save"))+"\r\n        ")])],1)])],1)],2)],1)],1)},[],!1,v,null,null);t.default=_.exports}});
//# sourceMappingURL=3.04b7008cb7602153bcc4.js.map